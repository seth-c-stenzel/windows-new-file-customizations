1. Copy the file type you wish to add to C:\Windows\ShellNew\
2. Modify / Run the registry script associated with that file type to add to the registry
3. Remove any unwanted menu items by watching the video: 
4. Use the icon cache rebuild tool.
5. Right click item types and change their open to default program to the correct program

*extra* 6. For batch files types only run the fix

For a video on all this you can check out youtube:
https://www.youtube.com/watch?v=S-ON_4kio0I&t=23s